row.names = F,
col.names = F,
append = T
)
#### LOG_LIK
# loglik_bayes <- cbind(step, extract(bayes$stanfit, pars = "log_lik")$log_lik)
# fwrite(loglik_bayes, file = paste0(model,"_", dist, "/results/loglik_bayes.txt"),
#             row.names = F,
#             col.names = F,
#             append = T
# )
### WAIC
waic <- matrix(c(step, bayes$waic$estimates[3,]), nrow = 1)
fwrite(waic, file = paste0(model,"_", dist, "/results/waic.txt"),
row.names = F,
col.names = F,
append = T
)
### LOO
loo <- matrix(c(step, bayes$loo$estimates[3,]), nrow = 1)
fwrite(loo, file = paste0(model,"_", dist, "/results/loo.txt"),
row.names = F,
col.names = F,
append = T
)
### SURVIVOR
new <- data.frame(numerical = mean(db$numerical),
categorical = 1)
surv_bayes_mean <- matrix(apply(survivor(bayes, new), 2, mean), nrow = 1)
surv_bayes_median <- matrix(apply(survivor(bayes, new), 2, median), nrow = 1)
fwrite(surv_bayes_mean, file = paste0(model,"_", dist, "/results/surv_bayes_mean.txt"),
row.names = F,
col.names = F,
append = T
)
fwrite(surv_bayes_median, file = paste0(model,"_", dist, "/results/surv_bayes_median.txt"),
row.names = F,
col.names = F,
append = T
)
}
else{
fwrite(matrix(c(step, "bayes", bayes[1]), nrow = 1), file = paste0(model,"_", dist, "/results/error.txt"),
row.names = F,
col.names = F,
append = T
)
}
## CENSORING + TIME
censntime <-matrix(c(step,
attributes(db)$censoring,
difftime(time1 = t2, time2 = t1, units = "sec"),
difftime(time1 = t4, time2 = t3, units = "sec")
), nrow = 1)
fwrite(censntime, file = paste0(model,"_", dist, "/results/censntime.txt"),
row.names = F,
col.names = F,
append = T
)
invisible()
}
library(data.table)
ph_llogis <- function(x){
message("step ", x)
simbp(step = x, dist = "llogis", model = "ph")
}
ph_llogis(1)
ph_llogis(10)
source('~/Documents/spsurv/script/load.R', echo=TRUE)
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno, data = veteran)
spsurv::spbp(Surv(time, status) ~ karno, data = veteran)
survival::coxph(Surv(time, status) ~ karno, data = veteran)
spbp(Surv(time, status) ~ karno, data = veteran)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
ifelse(model_flag == "aft",-1,+1)
model_flag = "ph"
ifelse(model_flag == "aft",-1,+1)
model_flag == "aft"
model_flag == "aft"+1
(model_flag == "aft")+1)
as.numeric(model_flag == "aft")+1)
as.numeric(model_flag == "aft")
as.numeric(model_flag == "aft")+1
(model_flag == "aft")+1)
(model_flag == "aft")+1
(model_flag == "aft")+1
(model_flag == "aft")+1
(model_flag == "aft")+1
(model_flag == "aft")+1
(model_flag == "aft")+1
(model_flag == "aft")+1
(model_flag == "aft")+1
(model_flag == "aft")
model_flag == "aft")+0
(model_flag == "aft")*-1
(model_flag == "aft")-1
(model_flag = "aft")
model_flag
(model_flag == "aft")-1
(model_flag == "aft")*1-1)
(model_flag == "aft")*1
(model_flag == "aft")*1-1
((model_flag == "aft")*2-1)
((model_flag == "aft")*2-1)
((model_flag == "aft")*2-1)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
e.ls()
objects(, envir = e)
e <- parent.frame()
objects(, envir = e)
assign(n, 1)
assign(x = n, 1)
assign(x = "n", 1)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
diag(0,'')
diag(0,1)
diag(0,2)
diag(0,6)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
devtools::load_all(".")
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux <- spbp(Surv(time, status) ~ karno + trt, data = veteran)
aux$var
diag(aux$var)
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran)
diag(aux1$var)
diag(aux2$var)
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F)
aux2
aux1
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = T)
aux2
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F, approach = "bayes")
devtools::load_all(".")
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran)
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
devtools::load_all(".")
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F, approach = "bayes")
devtools::load_all(".")
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F, approach = "bayes")
devtools::load_all(".")
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F, approach = "bayes")
devtools::load_all(".")
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F, approach = "bayes")
mode()
mode
devtools::load_all(".")
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F, approach = "bayes")
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F, approach = "bayes")
aux
aux2
devtools::load_all(".")
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F, approach = "bayes")
devtools::load_all(".")
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F, approach = "bayes")
axu2
aux2
extract(aux2$stanfit, pars  = c("beta", "gamma"))
extract(aux2$stanfit, pars  = c("beta", "gamma"))[[1]]
apply(extract(aux2$stanfit, pars  = c("beta", "gamma")), `[[`, print)
apply(extract(aux2$stanfit, pars  = c("beta", "gamma")), `[`, print)
extract(aux2$stanfit, pars  = c("beta", "gamma"))[[1]]
extract(aux2$stanfit, pars  = c("beta", "gamma"))[[2]]
apply(extract(aux2$stanfit, pars  = c("beta", "gamma")), `[[`, c)
devtools::load_all(".")
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F, approach = "bayes")
devtools::load_all(".")
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F, approach = "bayes")
aux2
aux1 <- survival::coxph(Surv(time, status) ~ karno + trt, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, scale = F, approach = "bayes", model = "po")
aux2
stan_densw(aux2$stanfit, pars  = c("beta", "gamma"))
stan_dens(aux2$stanfit, pars  = c("beta", "gamma"))
traceplot(aux2$stanfit, pars  = c("beta", "gamma"))
aux1 <- survival::coxph(Surv(time, status) ~ karno, data = veteran)
aux2 <- spbp(Surv(time, status) ~ karno, data = veteran, scale = F, approach = "bayes", model = "po")
c(1,1,1)
as.array(c(1,1,1))
class(as.array(c(1,1,1)))
dim(as.array(c(1,1,1)))
aux1 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, APPROACH )
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
aux1 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "mle" )
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
aux1
aux2
devtools::load_all(".")
aux1 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "mle" )
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
aux1
aux1 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "mle", scale = F )
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
aux1
aux1 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, APPROACH )
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
aux2
aux1
aux1 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "mle" )
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
aux1
aux1
aux1 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "mle" )
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
devtools::load_all(".")
aux1 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "mle" )
aux2 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
aux1
aux1
aux1 <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "mle" )
aux1
coxph(Surv(time, status) ~ karno + trt, data = veteran, approach = "mle" )
coxph(Surv(time, status) ~ karno + trt, data = veteran)
devtools::load_all(".")
coxph(Surv(time, status) ~ karno + trt, data = veteran)
coxph(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran)
spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
devtools::load_all(".")
spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
devtools::load_all(".")
spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
devtools::load_all(".")
spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
devtools::load_all(".")
spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
aux <- spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
aux$pmode
aux
summary(aux)
aux
aux$pmode
stan_dens(aux$stanfit)
stan_dens(aux$stanfit, pars = c("beta_scaled"))
stan_dens(aux$stanfit, pars = c("beta_std"))
source('~/Documents/spsurv/script/load.R', echo=TRUE)
spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
spsurv::spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
devtools::load_all(".")
spsurv::spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
devtools::load_all(".")
spsurv::spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
spsurv::spbp(Surv(time, status) ~ karno + trt, data = veteran, approach = "bayes")
data(veteran)
library(spsurv)
data(veteran)
fit <- spbp(Surv(time, status)~., data = veteran)
fit
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
library(spsurv)
data(veteran)
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
fit
summary(fit)
fit
fit <- spbp(Surv(time, status)~ trt, data = veteran, approach = "bayes")
summary(fit)
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran, approach = "bayes")
fit
summary(fit)
fit
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran, approach = "bayes)
fit <- spbp(Surv(time, status)~ trt, data = veteran)
fit
fit <- spbp(Surv(time, status)~ trt, data = veteran)
fit
fit$coefficients
fit$coefficients[1:1]
class(fit$coefficients[1:1])
class(fit$coefficients[1:2])
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
fit
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
fit
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
fit
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
fit
fit$var
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran)
fit
model.matrix(fit)
fit <- spbp(Surv(time, status)~ trt, data = veteran, approach = "bayes")
fit$call
View(fit$call)
fit$call[["formula"]][[3]]
class(fit$call[["formula"]][[3]])
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran, approach = "bayes")
fit
fit <- spbp(Surv(time, status)~ trt, data = veteran, approach = "bayes")
devtools::load_all(".")
fit
devtools::load_all(".")
devtools::load_all(".")
fit
devtools::load_all(".")
fit
fit$pmode
fit$y
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran, approach = "bayes")
fit
devtools::load_all(".")
fit <- spbp(Surv(time, status)~ trt, data = veteran, approach = "bayes")
fi
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
devtools::load_all(".")
fit
summary(fit)
fit <- spbp(Surv(time, status)~ trt, data = veteran, approach = "mle")
fit
fit$stanfit$coef
fit$stanfit$coefficientsd
fit$stanfit$coefficients
fit$stanfit
fit$coefficients
coxph(Surv(time, status)~ trt, data = veteran, approach = "mle")
coxph(Surv(time, status)~ trt, data = veteran)
survival::coxph(Surv(time, status) ~ karno, data = veteran)
spbp::spbp(Surv(time, status) ~ karno, data = veteran)
library("spsurv")
spsurv::spbp(Surv(time, status) ~ karno, data = veteran)
spbp(Surv(time, status) ~ karno, data = veteran)
survival::coxph(Surv(time, status) ~ karno, data = veteran)
spbp(Surv(time, status) ~ karno, data = veteran)
str(veteran)
spbp(Surv(time, status) ~ karno, data = veteran, approach = "bayes")
aux <- spbp(Surv(time, status) ~ karno, data = veteran, approach = "bayes")
View(aux)
aux$stanfit
aux <- spbp(Surv(time, status) ~ karno, data = veteran, approach = "mle")
