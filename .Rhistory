fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
library("KMsurv")
data("larynx")
library(spsurv)
library(spsurv)
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
summary(fit)
residuals(fit)
spsurv:::residuals.spbp(fit)
plot(spsurv:::residuals.spbp(fit))
approach = "mle",  data = larynx)
spsurv::bpph(formula = spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
spsurv::bpph(formula = spbp(Surv(time, delta)~age+factor(stage),
spsurv::bpph(formula = spbp(Surv(time, delta)~age+factor(stage),approach = "mle",  data = larynx)
spsurv::bpph(formula = spbp(Surv(time, delta)~age+factor(stage),approach = "mle",  data = larynx)
spbp(Surv(time, delta)~age+factor(stage)
spsurv::bpph(formula = Surv(time, delta)~age+factor(stage),  data = larynx)
spsurv::bpph(formula = Surv(time, delta)~age+factor(stage),  data = larynx)
spsurv::bpph(formula = Surv(time, delta)~age+factor(stage),  data = larynx)
spsurv::bppo(formula = Surv(time, delta)~age+factor(stage),  data = larynx)
spsurv::bppaft(formula = Surv(time, delta)~age+factor(stage),  data = larynx)
spsurv::bpaft(formula = Surv(time, delta)~age+factor(stage),  data = larynx)
bpaft(formula = Surv(time, delta)~age+factor(stage),  data = larynx)
spsurv::survivor(fit)
log(spsurv::survivor(fit))
-log(spsurv::survivor(fit))
-log(spsurv::survivor(fit))
-log(spsurv::survivor(fit))
spsurv::survivor(fit)
log(.99)
log(.98)
log(.90)
-log(spsurv::survivor(fit))
plot(-log(spsurv::survivor(fit)))
curve(exp(1))
curve(dexp(1))
curve(dexp(x))
plot(log(spsurv::survivor(fit)))
curve(dexp(x), add = T)
residuals(fit)
spsurv::residuals.spbp(fit)
spsurv:::residuals.spbp(fit)
survfit(spsurv:::residuals.spbp(fit))
spsurv:::residuals.spbp(fit)
survfit(Surv(spsurv:::residuals.spbp(fit), larynx$delta), 1)
Surv(spsurv:::residuals.spbp(fit), larynx$delta)
survfit(Surv(spsurv:::residuals.spbp(fit), larynx$delta)~1)
plot(survfit(Surv(spsurv:::residuals.spbp(fit), larynx$delta)~1))
kme <- survfit(Surv(spsurv:::residuals.spbp(fit), larynx$delta)~1)
fit
kme$time
plot(kme, pexp(kme$time, lower.tail = F, log.p = T))
pexp(kme$time, lower.tail = F, log.p = T)
pexp(kme$time, lower.tail = F, log.p = T)
pexp(kme$time, lower.tail = F, log.p = T)
pexp(kme$time, lower.tail = F, log.p = T)
pexp(kme$time, lower.tail = F, log.p = T)
pexp(kme$time, lower.tail = F, log.p = T)
pexp(kme$time, lower.tail = F, log.p = T)
pexp(kme$time, lower.tail = F, log.p = T)
kme
plot(kme$surv, pexp(kme$time, lower.tail = F, log.p = T))
abline(c(0,1))
plot(kme$surv, spsurv:::residuals.spbp(fit))
spsurv:::residuals.spbp(fit)
spsurv:::residuals.spbp(fit)
spsurv:::residuals.spbp(fit)
kme$surv
plot(kme$surv, spsurv:::residuals.spbp(fit))
library("spsurv")
library("spsurv")
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
fit$var
fit
fit$var
fit$coefficients
fit$linear.predictors
fit$means
fit$method
fit$n
fit$nevent
fit$terms
fit$y
fit$tau
bpaft(Surv(time, delta)~age+factor(stage),
approach = "mle", data = larynx)
bpaft(Surv(time, delta)~age+factor(stage),
approach = "bayes", data = larynx)
bpph(Surv(time, delta)~age+factor(stage),
approach = "bayes", data = larynx)
fit2 <- bpph(Surv(time, delta)~age+factor(stage),
approach = "bayes", data = larynx)
fit2
fit2
summary(fit2)
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
fit
summary(fit)
summary(fit2)
class(fit)
class(fit2)
fit3 <-  bpph(Surv(time, delta) ~ age + factor(stage),
approach = "bayes", model = "ph", data = larynx)
fit3 <-  apbp(Surv(time, delta) ~ age + factor(stage),
approach = "bayes", model = "ph", data = larynx)
fit3 <-  spbp(Surv(time, delta) ~ age + factor(stage),
approach = "bayes", model = "ph", data = larynx)
summary(fit3)
class(fit3)
print(fit3)
summary(fit2)
print(fit2)
fit2
View(fit2)
View(fit3)
fit2$approach
fit3$approach
fit2$call$approach
fit3$call$approach
setwd("~/Documents/spsurv")
if(!require(roxygen2)) install.packages('roxygen2')
if(!require(rstan)) install.packages('rstan')
if(!require(pkgbuild)) install.packages('pkgbuild')
if(!require(rstantools)) install.packages('rstantools')
if(!require(Rcpp)) install.packages('Rcpp')
try(remove.packages("spsurv", lib="~/R/x86_64-pc-linux-gnu-library/3.6"),
silent = T)
try(roxygen2::roxygenize(clean = T), silent = T)
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::load_all(".")
library(spsurv)
data("veteran")
library("KMsurv")
data("larynx")
# ML approach:
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
summary(fit)
vcov(fit)
coef(fit)
pkgbuild::compile_dll()
setwd("~/Documents/spsurv")
if(!require(roxygen2)) install.packages('roxygen2')
if(!require(rstan)) install.packages('rstan')
if(!require(pkgbuild)) install.packages('pkgbuild')
if(!require(rstantools)) install.packages('rstantools')
if(!require(Rcpp)) install.packages('Rcpp')
try(remove.packages("spsurv", lib="~/R/x86_64-pc-linux-gnu-library/3.6"),
silent = T)
try(roxygen2::roxygenize(clean = T), silent = T)
pkgbuild::compile_dll()
devtools::document()
devtools::install()
devtools::load_all(".")
devtools::build()
?spsurv::spbp
library(spsurv)
# ML approach:
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
summary(fit)
vcov(fit)
coef(fit)
model.matrix(fit)
stan_dens(fit)
traceplot(fit)
extract(fit)
# Bayesian approach:
fit2 <- spbp(Surv(time, delta) ~ age + factor(stage),
approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)
summary(fit2)
vcov(fit2)
coef(fit2)
vcov(fit2)
devtools::load_all(".")
# ML approach:
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
summary(fit)
vcov(fit)
coef(fit)
model.matrix(fit)
stan_dens(fit)
traceplot(fit)
extract(fit)
# Bayesian approach:
fit2 <- spbp(Surv(time, delta) ~ age + factor(stage),
approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)
summary(fit2)
vcov(fit2)
coef(fit2)
model.matrix(fit2)
stan_dens(fit2)
traceplot(fit2)
extract(fit2)
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
bpph(Surv(time, delta)~age+factor(stage),  approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)## PO model
bpph(Surv(time, delta)~age+factor(stage),  approach = "bayes",  data = larynx,
iter = 200, chains = 100, warmup = 10)## PO model
bpph(Surv(time, delta)~age+factor(stage),  approach = "bayes",  data = larynx,
iter = 200, chains = 1, warmup = 10)## PO model
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
spbp(Surv(time, delta) ~ age + factor(stage),
approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
## PO model
bppo(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
## AFT model
bpaft(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
devtools::load_all(".")
devtools::load_all(".")
# ML approach:
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
summary(fit)
vcov(fit)
coef(fit)
model.matrix(fit)
stan_dens(fit)
traceplot(fit)
extract(fit)
# Bayesian approach:
fit2 <- spbp(Surv(time, delta) ~ age + factor(stage),
approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)
summary(fit2)
vcov(fit2)
coef(fit2)
model.matrix(fit2)
stan_dens(fit2)
traceplot(fit2)
extract(fit2)
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
## PO model
bppo(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
## AFT model
bpaft(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
bpph(Surv(time, delta)~age+factor(stage),  approach = "bayes", data = larynx)## PO model
devtools::load_all(".")
data("veteran")
library("KMsurv")
data("larynx")
# ML approach:
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
summary(fit)
vcov(fit)
coef(fit)
model.matrix(fit)
stan_dens(fit)
traceplot(fit)
extract(fit)
# Bayesian approach:
fit2 <- spbp(Surv(time, delta) ~ age + factor(stage),
approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)
summary(fit2)
vcov(fit2)
coef(fit2)
model.matrix(fit2)
stan_dens(fit2)
traceplot(fit2)
extract(fit2)
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
bpph(Surv(time, delta)~age+factor(stage),  approach = "bayes", data = larynx)## PO model
fit <- bpph(Surv(time, delta)~age+factor(stage),  approach = "bayes", data = larynx)## PO model
fit
fit$call
fit$call$formula
devtools::load_all(".")
devtools::load_all(".")
library(spsurv)
data("veteran")
library("KMsurv")
data("larynx")
# ML approach:
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
summary(fit)
vcov(fit)
coef(fit)
model.matrix(fit)
stan_dens(fit)
traceplot(fit)
extract(fit)
# Bayesian approach:
fit2 <- spbp(Surv(time, delta) ~ age + factor(stage),
approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)
summary(fit2)
vcov(fit2)
coef(fit2)
model.matrix(fit2)
stan_dens(fit2)
traceplot(fit2)
extract(fit2)
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
fit <- bpph(Surv(time, delta)~age+factor(stage),  approach = "bayes", data = larynx)## PO model
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
eval(x~y)
devtools::load_all(".")
data("veteran")
library("KMsurv")
data("larynx")
# ML approach:
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
summary(fit)
vcov(fit)
coef(fit)
model.matrix(fit)
stan_dens(fit)
traceplot(fit)
extract(fit)
# Bayesian approach:
fit2 <- spbp(Surv(time, delta) ~ age + factor(stage),
approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)
summary(fit2)
vcov(fit2)
coef(fit2)
model.matrix(fit2)
stan_dens(fit2)
traceplot(fit2)
extract(fit2)
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
fit <- bpph(Surv(time, delta)~age+factor(stage),  approach = "bayes", data = larynx)## PO model
fit
fit$call$formula
parse(x~y)
eval(Surv(time, delta)~age+factor(stage))
devtools::load_all(".")
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
fit <- bpph(Surv(time, delta)~age+factor(stage),  approach = "bayes", data = larynx)## PO model
fit$call$formula
devtools::load_all(".")
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
fit <- bpph(Surv(time, delta)~age+factor(stage),  approach = "bayes", data = larynx)## PO model
fit$call$formula
fit
model.matrix(fit)
class(fit)
model.matrix(fit)
fit$call$data
devtools::load_all(".")
data("veteran")
library("KMsurv")
data("larynx")
# ML approach:
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
summary(fit)
vcov(fit)
coef(fit)
model.matrix(fit)
stan_dens(fit)
traceplot(fit)
extract(fit)
# Bayesian approach:
fit2 <- spbp(Surv(time, delta) ~ age + factor(stage),
approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)
summary(fit2)
vcov(fit2)
coef(fit2)
model.matrix(fit2)
stan_dens(fit2)
traceplot(fit2)
extract(fit2)
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
fit <- bpph(Surv(time, delta)~age+factor(stage),  approach = "bayes", data = larynx)## PO model
model.matrix(fit)
bpph(Surv(time, delta)~age+factor(stage),  approach = "bayes", data = larynx)## PO model
## PO model
bppo(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
bppo(Surv(time, delta)~age+factor(stage),  approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)## PO model
bppo(Surv(time, delta)~age+factor(stage),  approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)## PO model
## PO model
bppo(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
eval(larynx)
data("veteran")
devtools::load_all(".")
data("veteran")
library("KMsurv")
data("larynx")
# ML approach:
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
summary(fit)
vcov(fit)
coef(fit)
model.matrix(fit)
stan_dens(fit)
traceplot(fit)
extract(fit)
# Bayesian approach:
fit2 <- spbp(Surv(time, delta) ~ age + factor(stage),
approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)
summary(fit2)
vcov(fit2)
coef(fit2)
model.matrix(fit2)
stan_dens(fit2)
traceplot(fit2)
extract(fit2)
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
devtools::load_all(".")
data("veteran")
library("KMsurv")
data("larynx")
# ML approach:
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
bpph(Surv(time, delta)~age+factor(stage), approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)## PH model
devtools::load_all(".")
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
devtools::load_all(".")
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
devtools::load_all(".")
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
devtools::load_all(".")
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
devtools::load_all(".")
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
devtools::load_all(".")
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
bpph(Surv(time, delta)~age+factor(stage), approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)## PH model
## PO model
bppo(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
bppo(Surv(time, delta)~age+factor(stage),  approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)## PO model
## AFT model
bpaft(Surv(time, delta)~age+factor(stage),  data = larynx)## AFT model
bpaft(Surv(time, delta)~age+factor(stage),  approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)## PO model
library(spsurv)
data("veteran")
library("KMsurv")
data("larynx")
# ML approach:
fit <- spbp(Surv(time, delta)~age+factor(stage),
approach = "mle",  data = larynx)
summary(fit)
vcov(fit)
coef(fit)
model.matrix(fit)
stan_dens(fit)
# Bayesian approach:
fit2 <- spbp(Surv(time, delta) ~ age + factor(stage),
approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)
summary(fit2)
vcov(fit2)
# vcov(fit2)
coef(fit2)
# vcov(fit2)
# coef(fit2)
model.matrix(fit2)
stan_dens(fit2)
traceplot(fit2)
extract(fit2)
## PH model
bpph(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
bpph(Surv(time, delta)~age+factor(stage), approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)## PH model
## PO model
bppo(Surv(time, delta)~age+factor(stage),  data = larynx)## PO model
bppo(Surv(time, delta)~age+factor(stage),  approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)## PO model
## AFT model
bpaft(Surv(time, delta)~age+factor(stage),  data = larynx)## AFT model
bpaft(Surv(time, delta)~age+factor(stage),  approach = "bayes",  data = larynx,
iter = 20, chains = 1, warmup = 10)## PO model
